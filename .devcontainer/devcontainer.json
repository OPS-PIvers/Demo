{
  "name": "GAS + Gemini Pro Agent",
  "image": "mcr.microsoft.com/devcontainers/javascript-node:20",

  "onCreateCommand": "npm install -g @google/clasp@latest @google/gemini-cli@latest @types/google-apps-script",

  "postCreateCommand": "bash -c 'mkdir -p src .gemini/commands .gemini/skills/gas-pro && if [ ! -f .clasp.json ]; then echo \"{\\\"scriptId\\\":\\\"\\\",\\\"rootDir\\\":\\\"./src\\\"}\" > .clasp.json; fi && echo -e \"**/**\\n!src/**\\n!appsscript.json\\n.devcontainer/\\n.gemini/\" > .claspignore && if [ ! -f src/appsscript.json ]; then echo \"{\\\"timeZone\\\":\\\"America/New_York\\\",\\\"exceptionLogging\\\":\\\"STACKDRIVER\\\",\\\"runtimeVersion\\\":\\\"V8\\\"}\" > src/appsscript.json; fi && cat <<EOF > .gemini/commands/deploy.toml\ndescription = \"Update Web App\"\nprompt = \"\"\"\n1. Run clasp push --force.\n2. Run clasp deployments.\n3. Find the ID for web app.\n4. Run clasp deploy -i <ID>.\n\"\"\"\nEOF\ncat <<EOF > .gemini/commands/auth.toml\ndescription = \"Auth Clasp\"\nprompt = \"\"\"\n1. Explain that automated login is disabled.\n2. Ask the user to run \"clasp login\" in the terminal manually.\n3. Remind them to enable the GAS API at script.google.com.\n\"\"\"\nEOF\ncat <<EOF > .gemini/skills/gas-pro/SKILL.md\n---\nname: gas-pro\ndescription: Expertise in GAS V8 and Troubleshooting\n---\n- Troubleshooting: If clasp push fails, check https://script.google.com/home/usersettings and enable \"Google Apps Script API\".\n- Auto-Doc: Generate JSDoc headers for .gs functions when asked.\nEOF\ncat <<EOF > GEMINI.md\n# Project Context\n- Code is in /src. Manifest is at /src/appsscript.json.\n- Deployment: Use /deploy to update production.\nEOF\necho -e \"# ðŸš€ Pro Setup Guide\\n\\n### 1. Clasp Authentication\\nRun \\`clasp login\\` in the terminal below. Follow the link to authorize.\\n\\n### 2. Gemini Authentication\\nRun \\`gemini\\` and follow the prompts to add your API key.\\n\\n### 3. Permissions\\nEnable API: https://script.google.com/home/usersettings\" > GUIDE.md && code GUIDE.md'",

  "customizations": {
    "vscode": {
      "settings": {
        "editor.formatOnSave": true,
        "files.associations": { "*.gs": "javascript" },
        "editor.defaultFormatter": "esbenp.prettier-vscode",
        "google.gemini.chat.visible": false
      },
      "extensions": [
        "Google.geminicodeassist",
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode"
      ]
    }
  },

  "remoteUser": "node"
}
